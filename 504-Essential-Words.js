function updateHeaderHeight() {
    const h = document.getElementById('header').getBoundingClientRect().height;
    document.documentElement.style.setProperty('--header-height', h + 'px');
}

updateHeaderHeight();
window.addEventListener('resize', updateHeaderHeight);

const words = [
    [["լքել; թողնել; հրաժարվել","abandon"],["խանդավառ; թեժ; սուր","keen"],["նախանձ","jealous"],["տակտ; նրբազգացություն","tact"],["երդում; խոստում","oath"],["դատարկ; ազատ; չզբաղեցրած","vacant"],["դժվարություն; տառապանք","hardship"],["համարձակ; քաջ; բարեկիրթ","gallant"],["տվյալ; նյութ; ինֆորմացիա","data"],["անսովոր","anaccustomed"],["ամուրի; մագիստրոսի նախնական աստիճան","bachelor"],["համապատասխանել","qualify"]],
    [["դի; դիակ","corpse"],["թաքցնել; ծածկել; քողարկել","conceal"],["չարագույժ; հուսահատեցնող","dismal"],["սառը","frigid"],["բնակեցնել","inhabit"],["թմրել; թմրած","numb"],["վտանգ","peril"],["հակվել; հենվել","recline"],["ճիչ","shriek"],["նենգ; չար; վախեցնող","sinister"],["գրավել (տեսքով); գայթակղել","tempt"],["գրազ","wager"]],
    [["բնորոշ","typical"],["նվազագույն","minimum"],["հազվագյուտ; սակավաթիվ","scarce"],["տարեկան","annual"],["համոզել","persuade | հոմ․ convince"],["շատ կարևոր; էական","essential"],["խառնել","blend"],["տեսանելի","visible"],["թանկ","expensive"],["սիրած մարդ","beau"],["մշակել","devise"],["մեծածախ","wholesale | հակ․ retale - մանրածախ"]],
    [["գոլորշի","vapor"],["ոչնչացնել; վերացնել","eliminate"],["չարագործ","villain"],["խիտ","dense"],["օգտագործել","utilize"],["խոնավ","humid"],["տեսություն","theory"],["վայրէջք","descend | հակ․ ascent - վերելք"],["շրջանառել","circulate"],["հսկա; շատ մեծ; վիթխարի","enormous"],["գուշակել; նախատեսել","predict"],["անհետանալ","vanish"]],
    [["ավանդույթ","tradition"],["քաղաքից դուրս; գյուղական","rural | հակ․ urban - քաղաքային"],["բեռ","burden"],["ճամբար","campus"],["մեծամասնություն","majority | հակ․ minority - փոքրամասնություն"],["ժողով (ազգային); հավաքվել իրար գլխի","assemble"],["ուսումնասիրել; բացահայտել","explore"],["թեմա","topic"],["բանավեճ","debate"],["խուսանավել; խուսափել","evade"],["փորձ","probe"],["բարեփոխում","reform"]],
    [["մոտենալ; մոտեցում","approach"],["բացահայտել","detect"],["արատ; թերություն; սխալ","defect"],["աշխատող; աշխատակից","employee"],["անուշադրության մատնել","neglect"],["խաբել; մոլորության մեջ գցել","deceive"],["անկասկած","undoubtedly"],["հայտնի","popular"],["մանրակրկիթ","thorough"],["հաճախորդ","client"],["ամեն ինչ իր մեջ պարունակող; հասկանալ","comprehensive"],["դրամաշորդություն; անօրինական ձևով ուրիշից փող վերցնել","defraud"]],
    [["հետաձգել","postpone"],["թույլտվություն տալ; համաձայնություն տալ","consent"],["ծավալուն","massive"],["անոթ","capsule"],["պահպանել; արգելոց","preserve"],["պախարակել; քննադատել","denounce"],["եզակի; յուրահատուկ","unique"],["հոսանք; հեղեղ","torrent"],["նեղանալ; վիրավորվել; անտեսել","resent"],["անհանգստացնել (վատ իմաստ)","molest"],["մռայլ","gloomy"],["ոչ նախատեսված","unforeseen"]],
    [["չափազանցնել","exaggerate"],["սիրողական","amateur"],["միջակ","mediocre"],["բազմազանություն","variety"],["վավեր; հիմնավորված","valid"],["գոյատևել","survive"],["տարօրինակ","weird"],["նշանավոր; աչքի ընկնող","prominent"],["անվտանգություն","security"],["մեծածավալ; ծանրաշարծ; շատ տեղ զբաղեցնող","bulky"],["դժկամ","reluctant"],["ակնհայտ","obvious"]],
    [["հարևանությամբ; մոտակայք","vicinity"],["դար","century"],["ցասում; շատ ուժեղ զայրույթ","rage"],["փաստաթուղթ","document"],["եզրակացնել","conclude"],["անժխտելի","undeniable"],["դիմակայել","resist"],["(մի բանի) պակասը","lack"],["անտեսել; արհամարել","ignore"],["մարտահրավեր","challenge"],["փոքր մակետ","miniature"],["աղբյուր","source"]],
    [["գերազանցել","excel"],["կանացի","feminine"],["հեծնել; բարձրանալ","mount"],["մրցել","compete"],["սարսռալ","dread"],["առնական","masculine"],["սպառնալիք","menace"],["հակվածություն; տենդենց","tendency"],["թերագնահատել","underestimate | հակ․ overestimate - գերագնահատել"],["հաղթանակած","victorious"],["բազմաթիվ","numerous"],["ճկուն","flexible"]],
    [["վկայություն; փաստ; տվյալ","evidence"],["մենակյաց","solitary"],["տեսողություն; խորաթափանցություն","vision"],["հաճախակի; հաճախել","frequent"],["ակնարկ; վայրկյանական հայացք","glimpse"],["վերջերս պատահած","recent"],["տասնամյակ","decade"],["տատանվել; երկմտել","hesitate"],["անհեթեթ","absurd"],["ընդհարում; հակամարտություն","conflict"],["փոքրամասնություն","minority"],["հնարանք; կեղծիք","fiction"]],
    [["վառ(վ)ել","ignite"],["վերացնել; ոչնչացնել","abolish"],["քաղաքային","urban"],["բնակչություն","population"],["անկեղծ; անմիջական; պարզասիրտ","frank"],["կեղտոտել","pollute"],["բացել; բացահայտել","reveal"],["արգելել; թույլ չտալ","prohibit"],["անհետաձգելի; հրատապ; շտապ","urgent"],["բավարար","adequate"],["նվազում/ել; պակասեցում/նել","decrease"],["լսելի","audible"]],
    [["լրագրող","journalist"],["սով; քաղց","famine"],["ուշքի գալ/բերել; վերակենդանանալ; վերածնվել; վերականգնել","revive"],["սկս(վ)ել","commence"],["ուշադիր; օրինապահ; ճշտապահ","observant"],["նույնացնել; ճանաչել; ինքնությունը հաստատել","identify"],["վերաբնակվել; գաղթել","migrate"],["անոթ (ընդհանուր իմաստ)","vessel"],["համառել; շարունակել; դիմանալ","persist"],["մշուշապատ; միգամած; աղոտ","hazy"],["շողք/շողալ; փայլ/ել","gleam"],["խմբագիր","editor"]],
    [["անհնազանդ; անզուսպ; անկարգապահ","unruly"],["ախոյան; մրցակից; մրցող/ել; մրցակցող/ել","rival"],["բուռն; սաստիկ; կատաղի","violent"],["վայրագ; դաժան; գազանային","brutal"],["հակառակորդ","opponent"],["աղմկալի վեճ/վիճել; կռիվ/ել","brawl"],["կրկնօրինակ; պատճեն; ընդօրինակել; պատճենահանել","duplicate"],["չար; դաժան","vicious"],["պտույտ","whirling"],["դժբախտ; ձախորդ մարդ","underdog"],["հրել; խցկել; խոթել","thrust"],["շփոթված; շվարած","bewildered"]],
    [["ընդարձակ(վ)ել; ծավալ(վ)ել; զարգացնել; տարածվել","expand"],["փոխել","alter"],["հասուն/անալ; չափահաս (դառնալ)","mature"],["սուրբ; սրբազան","sacred"],["ստուգել; ուղղել; վերանայել","revise"],["գրավ (դնել); խոստանալ","pledge"],["պատահական; անփույթ; անկանոն","casual"],["հետապնդել","pursue"],["միաձայն","unanimous"],["հաջողակ","fortunate"],["պիոներ","pioneer"],["նորարար","innovative"]],
    [["բարակ; նուրբ; նրբագեղ","slender"],["գերազանցել; առաջ անցնել/ընկնել","surpass"],["լայն; լայնարձակ","vast"],["կասկածել; տարակուսել; չվստահել","doubt"],["ընդունակություն","capacity"],["թափանցել; ներթափանցել","penetrate"],["խոցել; ծակել","pierce"],["ճշգրիտ; ճիշտ","accurate"],["մանրադիտակ","microscope"],["երախտապարտ; շնորհակալ","grateful"],["զգույշ","cautious"],["վստահ; համարձակ; ինքնավստահ","confident"]],
    [["կոչ; դիմում","appeal"],["-մոլ; կախվածություն ունեցող անձ","addict"],["զգույշ","wary"],["տեղյակ; գիտակցող","aware"],["դժբախտություն; ձախորդություն","misfortune"],["խուսափել","avoid"],["թշվառ; դժբախտ","wretched"],["տակառ","keg"],["սնել; սնուցել","nourish"],["ծակող; անդուր; կոպիտ","harsh"],["քանակ","quantity"],["ընտրել; նախընտրել; գերադասել","opt"]],
    [["ողբերգություն","tragedy"],["հետիոտն","pedestrian"],["հայացք; նայվածք; նայել; հայացք ձգել","glance"],["բյուջե","budget"],["արագաշարժ; ժիր; ճարպիկ","nimble"],["ազդել ուրիշի վրա շահի համար","manipulate"],["անխոհեմ","reckless"],["սոսկալի; ահավոր","horrid"],["զառանցել","rave"],["տնտեսող; խնայող","economical"],["յուղել","lubricate"],["հնարամիտ; սրամիտ","ingenious"]],
    [["հունձ; բերք; բերքահավաք","harvest"],["առատ; լի; հարուստ","abundant"],["տհաճ; անհանգիստ; հուզված","uneasy"],["հաշվել; հաշվարկել","calculate"],["կլանել; ներծծել","absorb"],["գնահատում/ել","estimate"],["պատառ; փոքր կտոր","morsel"],["սահմանված չափ","quota"],["սպառնալիք; վտանգ","threat"],["արգելել; արգելք դնել","ban"],["խուճապ","panic"],["համապատասխան; յուրացնել","appropriate"]],
    [["հայտնվել","emerge"],["սրածայր; հերձոտ","jagged"],["հապաղել; ուշանալ; ձգձգել","linger"],["դարան","ambush"],["ճարպիկ; ճարտար; խորամանկ","crafty"],["","defiant"],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],
    [["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]]
];


let queue   = [];
let current = -1;
let showingAnswer = false;

function shuffle(arr) {
    const a = [...arr];
    for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
}

function getCheckedLessons() {
    const checked = [];
    for (let i = 1; i <= 42; i++) {
        const cb = document.getElementById('c' + String(i).padStart(2, '0'));
        if (cb && cb.checked) checked.push(i - 1);
    }
    return checked;
}

function setOutput(text, isAnswer = false) {
    const el = document.getElementById('arrows-output-text');
    el.textContent = text;
    el.classList.toggle('answer-mode', isAnswer);
    el.classList.remove('fade-word');
    void el.offsetWidth;
    el.classList.add('fade-word');
}

function updateStatus() {
    const el = document.getElementById('status');
    if (queue.length === 0) { el.textContent = ''; return; }
    el.textContent = `${current + 1} / ${queue.length}`;
}

function showWord() {
    showingAnswer = false;
    if (queue.length === 0 || current < 0) return;
    setOutput(queue[current][0], false);
    updateStatus();
}

function onRandomClick() {
    const lessons = getCheckedLessons();
    if (lessons.length === 0) {
        queue = []; current = -1;
        setOutput('pick a lesson ↑');
        updateStatus();
        return;
    }
    let pool = [];
    lessons.forEach(i => { if (words[i]) pool = pool.concat(words[i]); });
    queue   = shuffle(pool);
    current = 0;
    showingAnswer = false;
    showWord();
}

function onLeftArrowClick() {
    if (queue.length === 0) return;
    current = (current - 1 + queue.length) % queue.length;
    showWord();
}

function onRightArrowClick() {
    if (queue.length === 0) return;
    current = (current + 1) % queue.length;
    showWord();
}

function onAnswerClick() {
    if (queue.length === 0 || current < 0) return;
    showingAnswer = true;
    setOutput(queue[current][1], true);
    updateStatus();
}